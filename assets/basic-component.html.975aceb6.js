import{_ as n}from"./plugin-vue_export-helper.21dcd24c.js";import{o as s,c as a,e}from"./app.29a9c448.js";var t="/images/2816666215-5a25a21f9f37d.png";const p={},i=e('<h1 id="scrapy\u57FA\u672C\u7EC4\u4EF6" tabindex="-1"><a class="header-anchor" href="#scrapy\u57FA\u672C\u7EC4\u4EF6" aria-hidden="true">#</a> scrapy\u57FA\u672C\u7EC4\u4EF6</h1><h2 id="scrapy\u4F53\u7CFB\u6D41\u7A0B\u56FE" tabindex="-1"><a class="header-anchor" href="#scrapy\u4F53\u7CFB\u6D41\u7A0B\u56FE" aria-hidden="true">#</a> scrapy\u4F53\u7CFB\u6D41\u7A0B\u56FE</h2><p><img src="'+t+`" alt="" loading="lazy"></p><h2 id="spiders" tabindex="-1"><a class="header-anchor" href="#spiders" aria-hidden="true">#</a> spiders</h2><p><strong>\u57FA\u672C\u7528\u6CD5</strong><br> \u4F5C\u4E3A\u722C\u866B\u7684\u5F00\u59CB</p><ul><li><p>\u5F00\u59CB:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>scrapy genspider my_spider baidu.com

<span class="token comment"># template</span>
scrapy genspider my_spider baidu.com -d basic
<span class="token comment"># templates\u4F4D\u4E8Escrapy/templates/spiders</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u9700\u8981\u5B9E\u73B0start_request\u65B9\u6CD5 \u6216\u5B58\u5728 start_urls</p></li><li><p>request\u548Cresponse\u4E2D\u643A\u5E26meta\u5C5E\u6027</p></li><li><p><strong>\u5176\u4ED6</strong></p><ul><li>\u6A21\u62DF\u8868\u5355\u8BF7\u6C42\u7684FormRequest</li><li>\u5F02\u5E38\u8BF7\u6C42\u7684\u5904\u7406</li></ul></li></ul><hr><h2 id="items" tabindex="-1"><a class="header-anchor" href="#items" aria-hidden="true">#</a> Items</h2><p>item\u7528\u6765\u7ED3\u6784\u5316\u6570\u636E,\u6240\u6709\u7684item\u90FD\u8981\u5B9E\u73B0scrapy.Item</p><ul><li>\u6BCF\u4E2AItem\u4E3A\u4E00\u4E2A\u7C7B</li></ul><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">RestaurantItem</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Item<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># define the fields for your item here like:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="item-pipelines" tabindex="-1"><a class="header-anchor" href="#item-pipelines" aria-hidden="true">#</a> item pipelines</h2><p><strong>\u57FA\u672C\u7528\u6CD5</strong><em>pipeline\u7528\u6765\u5904\u7406Item\u5BF9\u8C61</em>, \u9700\u8981\u5B9E\u73B0\u7684\u65B9\u6CD5:</p><ul><li>process_item(self, item, spider) <strong>\u5FC5\u987B</strong></li><li><code>__init__</code> <strong>\u53EF\u9009</strong></li><li>from_crawler(cls, crawler) <strong>\u53EF\u9009</strong></li><li>open_spider(self, spider) <strong>\u53EF\u9009</strong></li><li>close_spider(self, spider) <strong>\u53EF\u9009</strong></li></ul><p>\u542F\u7528\u7F16\u5199\u597D\u7684pipelines</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>  <span class="token comment"># Configure item pipelines</span>
  <span class="token comment"># See https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>
  ITEM_PIPELINES <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">&#39;talabat_scrapy.pipelines.TalabatScrapyPipeline&#39;</span><span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4EE5\u5B98\u7F51\u7684MongoPipeline\u4E3A\u4F8B:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>  <span class="token keyword">import</span> pymongo

  <span class="token keyword">class</span> <span class="token class-name">MongoPipeline</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

      collection_name <span class="token operator">=</span> <span class="token string">&#39;scrapy_items&#39;</span>

      <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> mongo_uri<span class="token punctuation">,</span> mongo_db<span class="token punctuation">)</span><span class="token punctuation">:</span>
          self<span class="token punctuation">.</span>mongo_uri <span class="token operator">=</span> mongo_uri
          self<span class="token punctuation">.</span>mongo_db <span class="token operator">=</span> mongo_db

      <span class="token decorator annotation punctuation">@classmethod</span>
      <span class="token keyword">def</span> <span class="token function">from_crawler</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> crawler<span class="token punctuation">)</span><span class="token punctuation">:</span>
          <span class="token keyword">return</span> cls<span class="token punctuation">(</span>
              mongo_uri<span class="token operator">=</span>crawler<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;MONGO_URI&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              mongo_db<span class="token operator">=</span>crawler<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;MONGO_DATABASE&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;items&#39;</span><span class="token punctuation">)</span>
          <span class="token punctuation">)</span>

      <span class="token keyword">def</span> <span class="token function">open_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
          self<span class="token punctuation">.</span>client <span class="token operator">=</span> pymongo<span class="token punctuation">.</span>MongoClient<span class="token punctuation">(</span>self<span class="token punctuation">.</span>mongo_uri<span class="token punctuation">)</span>
          self<span class="token punctuation">.</span>db <span class="token operator">=</span> self<span class="token punctuation">.</span>client<span class="token punctuation">[</span>self<span class="token punctuation">.</span>mongo_db<span class="token punctuation">]</span>

      <span class="token keyword">def</span> <span class="token function">close_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
          self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

      <span class="token keyword">def</span> <span class="token function">process_item</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
          self<span class="token punctuation">.</span>db<span class="token punctuation">[</span>self<span class="token punctuation">.</span>collection_name<span class="token punctuation">]</span><span class="token punctuation">.</span>insert_one<span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span> item
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>\u6587\u4EF6\u7BA1\u9053 \u548C \u56FE\u7247\u7BA1\u9053</strong> \u4E24\u4E2A\u7BA1\u9053\u7684\u4F18\u70B9: <ul><li>\u907F\u514D\u4E0B\u8F7D\u91CD\u590D\u7684\u6587\u4EF6</li><li>\u53EF\u4EE5\u6307\u5B9A\u4E0B\u8F7D\u6587\u4EF6\u4F4D\u7F6E</li></ul></li></ul>`,20),o=[i];function l(c,u){return s(),a("div",null,o)}var m=n(p,[["render",l],["__file","basic-component.html.vue"]]);export{m as default};
