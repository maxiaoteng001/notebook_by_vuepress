import{_ as e}from"./plugin-vue_export-helper.21dcd24c.js";import{r as l,o,c as p,a as n,b as i,e as a,d as s}from"./app.29a9c448.js";const c={},u=a(`<h1 id="xpath" tabindex="-1"><a class="header-anchor" href="#xpath" aria-hidden="true">#</a> XPATH</h1><p>[TOC]</p><p>XPath\u5373\u4E3AXML\u8DEF\u5F84\u8BED\u8A00\uFF08XML Path Language\uFF09\uFF0C\u5B83\u662F\u4E00\u79CD\u7528\u6765\u786E\u5B9AXML\u6587\u6863\u4E2D\u67D0\u90E8\u5206\u4F4D\u7F6E\u7684\u8BED\u8A00\u3002 XPath\u57FA\u4E8EXML\u7684\u6811\u72B6\u7ED3\u6784\uFF0C\u63D0\u4F9B\u5728\u6570\u636E\u7ED3\u6784\u6811\u4E2D\u627E\u5BFB\u8282\u70B9\u7684\u80FD\u529B\u3002</p><h2 id="_1-\u7528\u6CD5" tabindex="-1"><a class="header-anchor" href="#_1-\u7528\u6CD5" aria-hidden="true">#</a> 1. \u7528\u6CD5</h2><ol><li><p>\u57FA\u672C\u7528\u6CD5</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree
html <span class="token operator">=</span> response<span class="token punctuation">.</span>text  <span class="token comment"># requests\u548Cscrapy\u90FD\u53EF\u4EE5, html\u8981\u6C42\u662Fstr</span>
page_source <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>html<span class="token punctuation">)</span>
tr <span class="token operator">=</span> page_source<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">&#39;//div[@class=&quot;chunk&quot;]/table/tr[1]&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>page_source HTML\u65B9\u6CD5\u6709\u81EA\u52A8\u4FEE\u6B63\u4E0D\u5168tag\u7684\u529F\u80FD, tostring()\u65B9\u6CD5\u8F6C\u6210\u6E90\u6587\u4EF6, \u4E3Abytes\u7C7B\u578B, \u9700\u8981decode\u4E3Astr</p></li><li><p>\u4E5F\u53EF\u4EE5\u76F4\u63A5\u8BFB\u53D6\u6587\u672C\u6587\u4EF6\u8FDB\u884C\u89E3\u6790</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree
html <span class="token operator">=</span> etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">&#39;./test.html&#39;</span><span class="token punctuation">,</span> etree<span class="token punctuation">.</span>HTMLParser<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
result <span class="token operator">=</span> etree<span class="token punctuation">.</span>tostring<span class="token punctuation">(</span>html<span class="token punctuation">)</span>
<span class="token comment"># \u53EF\u4EE5\u8F6C\u6362\u7F16\u7801\u95EE\u9898</span>
result <span class="token operator">=</span> etree<span class="token punctuation">.</span>tostring<span class="token punctuation">(</span>html<span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">,</span> pretty_print <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">&quot;html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u5BF9\u4E8Exml\u7684\u54CD\u5E94</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree
page_source <span class="token operator">=</span> etree<span class="token punctuation">.</span>XML<span class="token punctuation">(</span>response<span class="token punctuation">.</span>content<span class="token punctuation">)</span>  <span class="token comment"># requests</span>
page_source <span class="token operator">=</span> etree<span class="token punctuation">.</span>XML<span class="token punctuation">(</span>response<span class="token punctuation">.</span>body<span class="token punctuation">)</span>  <span class="token comment"># scrapy</span>
<span class="token comment"># \u5982\u679C\u4F7F\u7528text, &#39;\u53EF\u80FD\u62A5\u9519: Unicode strings with encoding declaration are not supported. Please use bytes input or XML fragments without declaration&#39;.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h2 id="_2-\u5E38\u7528\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#_2-\u5E38\u7528\u89C4\u5219" aria-hidden="true">#</a> 2. \u5E38\u7528\u89C4\u5219</h2>`,6),r=a("<li><p>/ # \u4ECE\u5F53\u524D\u8282\u70B9\u9009\u53D6\u6240\u6709\u5B50\u8282\u70B9, \u8FD4\u56DElist</p></li><li><p>// # \u4ECE\u5F53\u524D\u8282\u70B9\u9009\u53D6\u6240\u6709\u5B50\u5B59\u8282\u70B9, \u8FD4\u56DElist</p></li><li><p>. # \u9009\u53D6\u5F53\u524D\u8282\u70B9</p></li><li><p>.. # \u9009\u53D6\u5F53\u524D\u8282\u70B9\u7684\u7236\u8282\u70B9</p></li><li><p>@ # \u9009\u53D6\u5C5E\u6027</p></li><li><p>[@] # \u589E\u52A0\u5C5E\u6027\u9650\u5B9A \u5982://div[@class=&quot;xx-name&quot;], \u7236\u8282\u70B9\u4E0B\u6240\u6709class\u662Fxx-name\u7684div</p></li><li><p>/text() # \u6587\u672C\u83B7\u53D6, \u8FD4\u56DElist</p></li><li><p>\u5C5E\u6027\u591A\u503C\u5339\u914D # \u67D0\u4E2A\u8282\u70B9\u7684\u5C5E\u6027\u6709\u591A\u4E2A\u503C, \u6BD4\u5982<code>&lt;a class=&#39;li tag&#39;&gt;</code>,</p><ul><li>//li[contains(@class, &quot;li&quot;)] # \u9009\u62E9\u6240\u6709\u5305\u542Bli\u7684\u6807\u7B7E</li><li>//li[contains(@class, &quot;li&quot;) and contains(@class, &quot;tag&quot;)] # \u80FD\u9009\u62E9\u4E0A\u9762\u90A3\u4E2A\u6807\u7B7E</li><li>//li[contains(@class, &quot;li&quot;) and @name=&quot;item&quot;] # \u53EF\u4EE5\u540C\u65F6\u9009\u62E9\u591A\u4E2A\u5C5E\u6027\u6761\u4EF6</li></ul></li><li><p>| \u6216\u64CD\u4F5C</p><ul><li>//li[contains(@class, &quot;li&quot;)] | //li[@name=&quot;item&quot;] # \u7528\u6CD5\u548Cand\u7C7B\u4F3C</li></ul></li><li><p>\u6309\u5E8F\u9009\u62E9 # xpath\u7684list\u9009\u62E9\u662F\u4ECE1\u5F00\u59CB, last()\u8868\u793A\u6700\u540E\u4E00\u4E2A</p></li>",10),d=n("p",null,"\u8282\u70B9\u8F74",-1),h=n("li",null,"html = etree.HTML(text)",-1),k=n("li",null,"result = html.xpath('//li[1]/ancestor:\u{1F617}') # \u8FD4\u56DEli\u7684\u6240\u6709\u7956\u5148\u8282\u70B9, list",-1),m=n("li",null,"result = html.xpath('//li[1]/ancestor::div') # \u8FD4\u56DEli\u7684\u6240\u6709div\u7956\u5148\u8282\u70B9, list",-1),_=n("li",null,"result = html.xpath('//li[1]/attribute:\u{1F617}') # \u8FD4\u56DEli\u7684\u6240\u6709\u5C5E\u6027\u503C, list",-1),v=s(`result = html.xpath('//li[1]/child::a[@href="`),g={href:"https://ask.hellobi.com/link1.html",target:"_blank",rel:"noopener noreferrer"},x=s("https://ask.hellobi.com/link1.html"),b=s(`"]') # \u8FD4\u56DEli\u7684\u5B50\u8282\u70B9a`),q=n("li",null,"result = html.xpath('//li[1]/descendant::span') # \u8FD4\u56DEli\u7684\u6240\u6709span\u5B50\u5B59\u8282\u70B9, list",-1),f=n("li",null,"result = html.xpath('//li[1]/following:\u{1F617}[2]') # \u8FD4\u56DEli\u7684\u540E\u7EED\u7684\u7B2C2\u4E2A\u8282\u70B9",-1),y=n("li",null,"result = html.xpath('//li[1]/following-sibling:\u{1F617}') # \u8FD4\u56DEli\u7684\u540E\u7EED\u6240\u6709\u540C\u7EA7\u8282\u70B9, list",-1),L=n("li",null,"result = html.xpath('//li[1]/preceding-sibling::h6[1]') # \u8FD4\u56DEli\u7684\u524D\u9762\u7684\u540C\u7EA7\u8282\u70B9, list, [1]\u6307\u6700\u63A5\u8FD1li[1]\u7684, \u4F9D\u6B21\u5F80\u524D",-1);function w(M,X){const t=l("ExternalLinkIcon");return o(),p("div",null,[u,n("ul",null,[r,n("li",null,[d,n("ul",null,[h,k,m,_,n("li",null,[v,n("a",g,[x,i(t)]),b]),q,f,y,L])])])])}var H=e(c,[["render",w],["__file","xpath.html.vue"]]);export{H as default};
